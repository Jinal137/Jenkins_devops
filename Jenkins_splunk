pipeline {
    agent { label 'node1' }
   
    environment {
        TARGET_INSTANCE = 'jenkins@172.20.10.9'
    }
    stages {   
     
        stage('Transfer and Install Splunk') {
            steps {
                script {
                                  
                    sh "sudo scp splunk.tar ${TARGET_INSTANCE}:/home"
                   
                    sh """
                    ssh ${TARGET_INSTANCE} 'sudo dpkg -i /home/splunk.tar && sudo systemctl start splunk'
                    """
                }
            }
        }
    }

    post {
        success {
            echo 'Splunk installed and started successfully!'
        }
       
    }
}

